To install dependencies:
```sh
pnpm install
```

To run:
```sh
pnpm dev
```

open http://localhost:3003





## 运行前请先创建 .env 文件，并填入以下内容
```
PORT=3003
HOST=0.0.0.0
NODE_ENV=development
DATABASE_URL="mysql://root:123456@localhost:3307/lenovo_shop"

ACCESS_TOKEN_SECRET="dsyctyuioktytg78654tryuhihuesretyguiy5435sdtygy8uhbvgcfrd5"
REFRESH_TOKEN_SECRET="2345678e5dtyfg7y8ou9oljytyrydtvyg7h8ikjuytrdfyvhu"
QQ_EMAIL_USER=""
QQ_EMAIL_PASS=""
QQ_EMAIL_HOST="smtp.qq.com"

COOKIE_DOMAIN="localhost"
CORS_ORIGINS="http://localhost:3000"
```

## pnpm prisma generate // 生成数据库文件
## pnpm prisma migrate dev --name init  // 创建数据库表


// 数据库

品牌表
id
品牌名称
品牌编码 （如Lenovo）
品牌描述
品牌logo
状态 （启用/禁用/下架）
添加时间
添加者id （创建该品牌的管理员id）
更新时间
备注

商品品类表
id
品类名称 顶级品类：（笔记本，台式机，显示器，平板，手机，配件，服务 ……）
品类编码 （NOTEBOOK、DESKTOP、MONITOR、PAD、PHONE、ACCESSORIES、SERVICE ……）
父级品类id
状态 （启用/禁用）
添加时间
添加者id （创建该品类管理员id）


商品基本信息表
id
商品品牌id
商品品类id
商品名称
商品副标题
商品描述
商品主图
添加时间
添加者id （创建该商品的管理员id）
更新时间
状态 （正常 / 下架 / 删除）

商品标签表
id
标签名称
展示优先级
状态 （启用/禁用）
添加时间
添加者id （创建该标签的管理员id）
备注


商品-标签关联表
id
商品id
标签id
关联时间
状态（生效/失效）

商品配置表
id
商品id
配置1（颜色等）
配置2 （内存等，16G+512G等）
配置3 （可选，尺寸等）
售价
原价
配置图片
创建时间
更新时间
状态 （正常 / 下架 ）


商品介绍宣传图表（商品详情页下面的介绍海报）
id
商品id
序号
宣传图
添加时间



商品外观图表
id
商品id
外观图
添加时间

货架商品表
id
货架专区id (品类表id)
商品id
专栏轮播 bool
专栏轮播海报
自营 bool
可定制 bool
分期 （0/6/12/24）
以旧换新 bool
上架时间
更新时间
下架时间
状态 （在售/售罄/下架）



库存表
id
商品配置id
库存数量
冻结数量
库存预警数量 （低于该数量时发送预警）
更新时间 （入库/出库/冻结/解冻）
最后入库时间
最后出库时间

上架商品数量表
id
货架商品id
商品id
商品配置id
上架数量 
锁定数量 （订单未支付时锁定库存）
更新时间


新品推送表
id
货架商品id
新品轮播 bool
新品专区轮播海报
生效时间
结束时间
状态 （展示中，已下架）

首页推送表
id
货架商品id
首页轮播 bool
首页区轮播海报
生效时间
结束时间
状态 （展示中，已下架）


秒杀轮次表
id
秒杀轮次标题
秒杀开始时间
秒杀结束时间
状态 （启用/禁用/已结束）
添加时间
添加者id （创建该秒杀轮次的管理员id）
备注

秒杀商品表
id
轮次id
商品id
优惠方式 （立减/打折 2择1）
优惠金额 （立减）
优惠折扣 （打折）

秒杀商品配置表
id
秒杀商品id
商品配置id
上架数量
剩余数量
锁定数量 （防止超卖）
直接秒杀价 （手动设置的，与优惠无关）
添加时间
更新时间
状态 （正常 / 售罄 ）


购物车表
id
用户id
商品id
配置id
数量
状态 （有效/无效）
商品价格 
添加时间  
更新时间


领券中心表
id
优惠券id
可领取时间
可领取数量
截止时间
领取限制 （每人限领）
添加者id （创建该领券中心的管理员id）
添加时间

优惠券表
id
优惠券名称
优惠券类型 （满减/折扣）
优惠金额
优惠折扣率
门槛金额
使用条件描述
使用范围描述
开始时间
过期时间
可叠加 bool
添加者id （创建该优惠券的管理员id）
添加时间
备注

代金券
id
标题
描述
原始金额
开始时间
结束时间
创建者id （创建该代金券的管理员id）
备注


商品-优惠券可用关联表
id
商品id
优惠券id
状态 （生效/失效）
关联时间
操作人id （创建该关联的管理员id）
备注

用户-优惠券持有关联表
id
用户id
优惠券id
优惠券状态 （未使用 / 已使用 / 已过期 ）
领取时间
使用时间
关联订单id
实际优惠金额

用户-代金券持有关联表
用户id
代金券id
代金券状态 bool
获取时间
用尽时间
使用金额
剩余金额


订单-代金券使用关联表
订单id
代金券id
使用金额
使用时间


订单-商品表
id
订单id
商品id
商品配置id
商品数量
商品价格快照
商品优惠快照
商品实付金额快照
商品名称快照
商品主图快照
配置1快照
配置2快照
配置3快照

订单表
id
用户id
订单号 (时间戳+随机数,20位数字)
订单状态（待支付/待发货/已发货/待收货/已收货/已取消）
支付方式 
支付金额
实际支付金额
支付时间
收货快照-省编码
收货快照-市编码
收货快照-区县编码
收货快照-街道编码
收货快照-详细地址
订单备注
收货快照-收货人
收货快照-手机号
物流单号
订单创建时间
支付限制时间 （未在限制时间内支付默认取消）
订单取消时间
订单发货时间
订单收货时间
订单完成时间
用户可见状态 bool （用户删除订单后设置false）


售后-图片表
id
售后id
图片


售后表
id
订单id
售后单号
订单商品id
售后类型 （退货/换货/维修）
售后状态 （申请中/已同意/已拒绝/已寄回/已寄出/已完成）
售后原因
售后备注
申请时间
同意时间
拒绝时间
同意/拒绝原因
用户寄回物流单号
收货快照-省编码
收货快照-市编码
收货快照-区县编码
收货快照-街道编码
收货快照-详细地址
订单备注
收货快照-收货人
收货快照-手机号
商家寄出物流单号
发货快照-省编码
发货快照-市编码
发货快照-区县编码
发货快照-街道编码
发货快照-详细地址
订单备注
发货快照-收货人
发货快照-手机号
寄回时间
寄出时间
完成时间
处理者id


吐槽-图片表
id
吐槽id
图片

吐槽表
id
用户id
订单id
订单商品id
吐槽内容
点赞数
添加时间
更新时间
状态 （撤回/正常/用户删除<即用户不可见>）

吐槽-商家回复表
id
吐槽id
回复内容
回复时间
回复者id （管理员id）
点赞数
状态 （撤回/正常/用户删除<即用户不可见>）



评价-图片表
id
评价id
图片

商品评价表
id
用户id
商品id
商品配置id
评价星星数 （1~5，可以0.5为单位）
点赞数
评价内容
添加时间
更新时间
状态 （撤回/正常/用户删除<即用户不可见>）

评价-商家回复表
id
评价id
回复内容
回复时间
回复者id （管理员id）
点赞数
状态 （撤回/正常/用户删除<即用户不可见>）

投诉-图片表
id
投诉id
图片

售后投诉表
id
用户id
售后id
投诉内容
添加时间
更新时间
处理 bool
处理者id
处理时间
处理结果
状态 （/撤回/正常/用户删除<即用户不可见>）


省 / 市 / 区（县）/ 街道 4 级行政区划字典表
行政区划编码
行政区划名称
上级行政区划编码
行政区划层级


收货信息表
id
用户id
省份编码
城市编码
区县编码
街道编码
详细地址
收货人
手机号
是否默认bool
创建时间
更新时间


管理员表
id
账号
密码
姓名
邮箱
头像
工作昵称  （Lenovo客服小李类似的）
状态（启用/禁用）
创建时间
最后登陆时间
创建者id （创建该管理员的管理员id）

管理员-身份关联表
id
管理员id
身份id
分配者id （分配该身份的管理员id）
分配时间
状态 （启用/禁用）
失效时间 （临时身份分配时有效）

管理员-商品专区关联表
id
管理员id
专区id （品类表id）
创建者id （创建该专区管理员的管理员id）
创建时间
状态 （启用/禁用）


身份表
id
身份名称 （超级管理员（拥有一切权限），系统管理员，核销员 ，客服）
身份编码
身份描述
系统预设 bool
状态 （启用/禁用）
创建时间
创建者id （创建该身份的管理员id）


身份-权限关联表
id
身份id
权限id  
分配者id （分配该权限的管理员id）
分配时间
状态 （启用/禁用）


权限表
id
权限名称 （（比如商品管理 - 查询、商品管理 - 新增、商品管理 - 编辑、商品管理 - 删除、订单管理 - 核销 等等）
权限类型
父级权限id （如 “商品管理” 是 “商品管理 - 查询” 的父级）
模块名称 （权限所属模块）
状态 （启用/禁用）



系统全局消息表
id
发送者id （管理员）
通知类型（公告，提醒，活动，通知）
标题
内容
发送时间
生效时间 （支持定时推送）
过期时间 （过期后自动隐藏）
状态 （正常/撤回/下架）

个人通知消息表
id
发送者id （管理员）
通知类型（公告，提醒，活动，通知）
标题
内容
发送时间
生效时间 （支持定时推送）
过期时间 （过期后自动隐藏）
状态 （正常/撤回/下架）

用户-系统通知表
id
用户id
消息类型 （个人/全局）
个人通知id
全局通知id
通知时间 （消息推送给用户的时间（个人消息）/ 用户首次查看的时间（全局消息））
已读 bool
已读时间
是否删除 bool


用户-客服对话新消息通知表
id
用户id
会话室id
关联消息id
通知对象类型 （用户/管理员）
对象id （用户id/管理员id）
回复源消息id
删除 bool
删除时间
通知时间
状态 （已读/未读）


用户-客服对话窗口列表
用户id
会话室id
管理员id 
用户删除 bool
用户删除时间
管理员删除 bool 
管理员删除时间

客服-用户会话室
id
用户id
管理员id （客服身份）
用户未读消息数量
管理员未读消息数量
会话创建时间
结束时间
状态 （已结束/进行中）

客服-用户会话室-消息表
消息主键id
会话室id
发送者身份 （用户/管理员）
发送者id （用户id/管理员id）
接收者身份 （用户/管理员）
接收者id （用户id/管理员id）
接收者已读 bool
已读时间
消息内容
发送时间
状态 （撤回/正常）两分钟内可撤回
撤回时间
被回复信息id
回复层级数

用户-客服评价表
id
用户id
会话室id
客服id （管理员id）
评价内容
评价星星数 （1~5，可以0.5为单位）
添加时间
更新时间
状态 （撤回/正常）
撤回原因 

客服指标表
id
客服id （管理员id）
会话数
已评价会话数
平均星星数
好评数 （4以上）
好评率 （好评数/评价会话数）
统计时间

管理员Session 表
id
管理员id
session唯一标识符
存储的管理员信息（json格式）
过期时间
创建时间
修改时间

管理员登陆表
id
管理员id
session id
设备名称
设备类型（手机/电脑）
登陆时间
登陆ip
登出时间
session过期时间